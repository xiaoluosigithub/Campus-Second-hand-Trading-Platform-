## 当前状态
- 已完成功能：认证、商品（浏览/发布/编辑/上下架/我的）、购物车与单品下单（并发/事务）、订单流转（发货/确认/我的订单）、后台审核与分类、消息模块（对话/发送/联系人/未读/标记已读）、后台订单统计（日/区间）、商品详情浏览量递增与卖家信息。
- 与 PRD差距：支付模拟接口、图片上传（前端发布更顺畅）、分类面包屑与树接口、后台用户管理与基础运营能力、体验与安全增强。

## M7：支付模拟与图片上传、分类面包屑
### 支付模拟（最小实现）
- 接口：`POST /api/pay/mock`（入参：`orderId`, `method=alipay|wechat`）
- 行为：返回“支付成功”，不改变当前订单业务状态（现有创建订单即为待发货）；用于前端流程演示与联调。
- 规则：仅订单的买家可调用；订单状态为取消则提示不可支付。

### 图片上传（发布商品所需）
- 接口：`POST /api/files/upload`（`multipart/form-data`：`file`）→ 返回 `url`
- 存储：课程设计场景采用本地磁盘存储目录（如 `/uploads`），静态资源映射为 `http://localhost:8080/uploads/...`
- 规则：限制文件类型（png/jpg/jpeg/webp）与大小（如≤5MB）。

### 分类面包屑与树
- 面包屑：`GET /api/categories/{id}/path` → 返回从根到该分类的数组
- 分类树：`GET /api/categories/tree` → 返回嵌套结构，便于前端构建导航与筛选

## M8：后台用户管理与运营能力
### 后台用户管理
- 列表与搜索：`GET /api/admin/users?page&size&keyword`
- 更新角色：`PATCH /api/admin/users/{id}/role`（`role=user|admin`）
- 冻结/解冻：`PATCH /api/admin/users/{id}/status`（`active|disabled`）
- 规则：仅管理员；对自身操作限制（避免自锁）。

### 运营辅助（可选）
- 简单公告配置：`GET/POST /api/admin/announcements`（用于前端显示提示）

## M9：体验与安全增强
- 排序扩展：列表支持 `sort=price_desc|price|newest`
- 搜索增强：关键词trim去重、空结果提示由前端处理；后端返回一致化分页结构
- 安全与限流：消息发送内容长度限制（≤500），基础速率限制（可用内存滑窗/令牌桶简单实现）
- 索引检查与性能：
  - `orders(buyer_id,seller_id,created_at,status)`
  - `products(category_id,created_at)`
  - `messages(sender_id,receiver_id,created_at)`
- 日志合规：订单状态流转、审核操作记录info日志（不含敏感信息）

## 文档与交付
- 完成每阶段后更新 `document/接口文档.md` 与 `document/已实现功能.md`，补充curl示例与错误码；提交 Postman/Apifox 用例集合。

## 起步任务（确认后执行）
1) 实现支付模拟与图片上传、分类面包屑/树接口；
2) 实现后台用户管理（列表/角色/状态）；
3) 排序与消息发送的校验增强；
4) 更新所有文档与用例集合，并编译验证。