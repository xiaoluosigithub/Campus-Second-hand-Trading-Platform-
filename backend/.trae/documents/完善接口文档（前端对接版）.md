## 文档完善目标
- 提供一份“可直接用于前端开发”的接口手册：统一说明、参数表、请求/响应示例、curl示例与错误码对照。
- 覆盖新增能力：获取个人资料、订单预校验、商品/我的商品的 status/keyword 筛选、管理员审核驳回理由必填说明。

## 全局说明与错误码
- 基础地址与认证：`http://localhost:8080`；基于 Session（登录后携带 Cookie）。
- 统一响应：`{"code":200,"message":"OK","data":...}`；错误返回含具体 message。
- 错误码：200/400/401/409/422；分页 `size` 范围 1–50；时间采用 ISO8601 字符串。

## 认证接口
- 注册：`POST /api/auth/register`（username/password/nickname）
- 登录：`POST /api/auth/login`（返回 `Set-Cookie: JSESSIONID`）
- 登出：`POST /api/auth/logout`
- curl 示例：注册/登录/登出各 1 条

## 用户接口
- 获取个人资料：`GET /api/users/me`（返回 username/nickname/avatarUrl/signature/role/createdAt/updatedAt）
- 编辑个人资料：`PATCH /api/users/me/profile`（nickname/avatarUrl/signature 可选）
- curl 示例：获取/编辑各 1 条

## 商品接口（浏览）
- 列表：`GET /api/products` 参数：page/size/category/status/keyword/sort/excludeActive
- 详情：`GET /api/products/{id}`（浏览量递增，返回 seller 信息）
- curl 示例：常规列表、带 status/keyword 列表、详情

## 商品接口（发布与管理）
- 发布：`POST /api/products`
- 编辑：`PUT /api/products/{id}`（仅价格/描述；编辑后置 `status=0` 且待审核不可编辑）
- 修改状态：`PATCH /api/products/{id}/status`（仅 1 在售 / 4 下架）
- 删除：`DELETE /api/products/{id}`（仅 0/2/4；无关联订单）
- 取消发布：`POST /api/products/{id}/cancel`（在售→下架；0/2/4 按删除处理）
- 我的商品：`GET /api/products/me` 参数：page/size/status/keyword/sort
- curl 示例：发布/编辑/改状态/删除/取消/我的商品筛选各 1 条

## 购物车接口
- 添加：`POST /api/cart`
- 查询：`GET /api/cart`（分页）
- 移除：`DELETE /api/cart/{productId}`
- 清除失效：`POST /api/cart/cleanup`
- curl 示例：添加/查询/移除/清除各 1 条

## 订单接口
- 创建：`POST /api/orders`（校验在售、非本人、无进行中订单、支付方式合法；创建后状态 0）
- 取消：`POST /api/orders/{id}/cancel`（仅状态 0）
- 发货：`PATCH /api/orders/{id}/ship`（仅状态 0，必填 trackingNumber，置状态 1）
- 确认收货：`PATCH /api/orders/{id}/confirm`（仅状态 1，置状态 2，并将商品置 3 已售出）
- 我买到的：`GET /api/orders/me/bought`
- 我卖出的：`GET /api/orders/me/sold`
- 订单预校验：`GET /api/orders/precheck?productId=`（返回是否“在售且无进行中订单”）
- curl 示例：创建/取消/发货/确认/预校验各 1 条

## 消息接口（留言板）
- 对话查询：`GET /api/messages?contactId=&page&size`
- 发送：`POST /api/messages`（receiverId/content）
- 最近联系人：`GET /api/messages/contacts`
- 未读数量：`GET /api/messages/unread/count`
- 标记已读：`POST /api/messages/{id}/read`
- curl 示例：查询/发送/未读/已读各 1 条

## 分类导航
- 分类树：`GET /api/categories/tree`（当前平铺结构）
- 面包屑路径：`GET /api/categories/{id}/path`（单层：仅返回该分类本身）
- curl 示例：树/路径各 1 条

## 管理后台接口（管理员）
- 商品审核：`PATCH /api/admin/products/{id}/review`（仅待审核；通过→在售；驳回→审核不通过，`reason` 必填且非空）
- 分类管理：`GET/POST/DELETE /api/admin/categories`
- 用户管理：`GET /api/admin/users`；`PATCH /api/admin/users/{id}/role`；`DELETE /api/admin/users/{id}`
- 订单列表与详情：`GET /api/admin/orders`；`GET /api/admin/orders/{id}`（支持 buyerId/sellerId/status/date）
- 订单统计：`GET /api/admin/stats/orders`；`GET /api/admin/stats/orders-range`
- curl 示例：审核（通过/驳回）、用户改角色、订单列表筛选、日统计各 1 条

## 文件上传与支付模拟
- 上传图片：`POST /api/files/upload`（png/jpg/jpeg/webp ≤5MB；返回 `/uploads/...`）
- 支付模拟：`POST /api/pay/mock?orderId=&method=`（不改变订单业务状态；已取消订单不可支付）
- curl 示例：上传/支付各 1 条

## 附：统一示例块（集中）
- 提供拷贝即用的 curl 示例块：
  - 认证：注册/登录/登出
  - 用户：获取/编辑个人资料
  - 商品：列表（含 status/keyword/excludeActive）、详情、发布/编辑/状态/删除/取消、我的商品筛选
  - 购物车：添加/查询/移除/清除失效
  - 订单：创建/取消/发货/确认/预校验
  - 消息：查询/发送/未读/已读/联系人
  - 分类：树/路径
  - 后台：审核（通过/驳回）、用户改角色、订单列表（含筛选）、统计（日/区间）
  - 上传/支付

## 实施方式
- 仅更新 `document/接口文档.md`：在各章节插入参数说明、请求/响应 JSON 与 curl 示例；在后台审核章节明确 `reason` 必填；在分类导航章节强调单层路径。
- 不改动数据库与后端行为，仅补充文档内容。