## 现状回顾

* 后端已实现：认证、商品（浏览/发布/编辑/上下架/我的）、购物车与单品下单（并发事务）、订单流转（发货/确认/我的订单）、后台审核与分类、消息模块（对话/发送/联系人/未读/标记已读）、订单统计（日/区间）、分类树/面包屑、文件上传、支付模拟、商品详情浏览量递增与卖家信息。

* PRD剩余关注点：后台用户管理与运营辅助、排序与搜索体验、限流与安全、联调用例完善。

## M8：后台用户管理与运营辅助

* 接口

  * 用户列表与搜索：`GET /api/admin/users?page&size&keyword`

  * 更新角色：`PATCH /api/admin/users/{id}/role`（`role=user|admin`）

  * 更新状态：`PATCH /api/admin/users/{id}/status`（`active|disabled`）

  * 公告配置（可选）：`GET/POST /api/admin/announcements`（前端展示提示）

* 规则

  * 仅管理员访问 `/api/admin/**`；禁止管理员自锁（自身状态/角色修改需额外确认或禁止）。

* 文档与测试

  * 接口文档新增契约与示例；测试覆盖权限校验、搜索分页、角色/状态更新边界。

## M9：排序与搜索体验、安全与限流

* 排序扩展

  * 商品列表支持 `sort=price_desc|price|newest`（默认 `newest`）；服务层统一应用排序。

* 搜索体验

  * 关键词 `trim` 与空字符串处理；返回一致化分页结构，前端空态提示以 PRD 为准。

* 安全与限流

  * 消息内容长度限制（≤500），防止超长输入；简易速率限制（内存滑窗/令牌桶）。

  * 统一错误提示中文化，分页 `size≤50` 规范化校验。

* 性能与索引

  * 检查并确保查询字段具备索引：`orders(buyer_id,seller_id,created_at,status)`、`products(category_id,created_at)`、`messages(sender_id,receiver_id,created_at)`。

* 文档与测试

  * 更新排序与搜索说明；限流与内容长度的错误示例；端到端用例。

## M10：联调用例与交付完善

* 用例集合

  * 提交 Postman/Apifox 集合，覆盖全接口（认证、商品、购物车、订单流转、后台管理、消息、统计、上传/支付）。

* 日志与审计

  * 关键操作记录 info 日志：订单状态流转、审核、角色/状态变更（不含敏感信息）。

* 开发者说明（简版）

  * 在接口文档中补充错误码约定、分页规则、排序说明的统一章节，便于前端接入。

## 交付与验收

* 每阶段完成后更新 `document/接口文档.md` 与 `document/已实现功能.md`，附 curl 示例与错误场景；编译验证通过。

* 验收标准：管理员用户管理可用、排序与搜索体验一致、限流与内容校验生效、用例集合可跑通主要流程。

## 起步任务（确认后执行）

1. 实现管理员用户管理（列表/搜索、角色、状态）与公告接口；
2. 扩展商品排序并完善搜索校验；
3. 实现消息长度限制与基础限流；
4. 更新文档与用例集合并通过构建验证。

