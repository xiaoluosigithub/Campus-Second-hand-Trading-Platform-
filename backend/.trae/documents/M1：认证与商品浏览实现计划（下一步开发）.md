## 当前进度
- 已完成实体、Mapper、Service（User、Product、Category、ShoppingCart、Order、Message），构建通过。
- 数据库与数据源已配置，工程可编译运行。

## 下一步目标（小步快跑）
- 实现会话认证与商品浏览的最小可用接口，满足 PRD 的“登录/注册”与“主页商品列表/详情/筛选/排序”。

## 任务拆分
1) 统一异常与响应
- 新增 `@RestControllerAdvice`：401（未登录）、403（禁止）、409（冲突）、422（参数错误）。
- 统一响应结构（成功/错误），分页响应包含总数与页码信息。

2) 登录态拦截器（HttpSession）
- `HandlerInterceptor` 检查 Session 中 `userId`，未登录的受保护接口返回 401。
- 放行白名单：`/api/auth/*`、商品浏览（GET 列表与详情）、静态/Mock 资源。

3) 认证接口
- `POST /api/auth/register`：BCrypt 哈希；重复账号返回 409；默认昵称=账号。
- `POST /api/auth/login`：验证通过后写入 Session（`userId`、`nickname`、`role`）。
- `POST /api/auth/logout`：清理 Session。

4) 商品列表与详情
- `GET /api/products`：`page/size/category/keyword/sort=price|newest`；`size` 默认 10，最大 50。
- `GET /api/products/{id}`：返回完整商品信息（含 images 列表、卖家昵称等后续可补充）。
- 排序说明：`price` 按价格升序；`newest` 按 `created_at` 降序。

5) 基础校验
- 使用 `jakarta validation` 对分页与必填参数校验；空结果返回空状态描述。

6) 验证与用例
- Postman/Apifox 集合：注册→登录→浏览列表→查看详情。
- 单测：UserService 注册重复、登录成功/失败；ProductService 分页与筛选。

## 验收标准
- 未登录访问受保护接口返回 401；登录后拿到 Session 并可调用受限接口。
- 商品列表分页与筛选、排序生效；详情接口返回合理字段与 images（JSON→List）映射正确。
- 所有接口错误码与提示一致、参数校验清晰。

## 后续阶段预告
- M2：商品发布/编辑/上下架（含 IDOR 防护）；“我的商品”分页。
- M3：购物车最小闭环与单品下单（事务与并发校验、取消回滚）。
- M4：订单发货/确认收货；管理员审核与分类最小接口。
- M5：消息简版与 Mock 图片接口。